<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AI Watermark Applier - Make realistic videos look AI generated.</title>
    <style>
      :root {
        --bg: #071028;
        --panel: #0b1624;
        --accent: #2563eb;
        --muted: #9fb8e3;
        color-scheme: dark;
      }
      body {
        font-family: Inter, system-ui, -apple-system, Arial;
        padding: 18px;
        background: var(--bg);
        color: #e6eef8;
      }
      .panel {
        background: var(--panel);
        padding: 12px;
        border-radius: 8px;
        box-shadow: 0 6px 18px rgba(2, 6, 23, 0.6);
        margin-bottom: 12px;
      }
      label { display: block; margin: 6px 0 4px; font-size: 13px; color: var(--muted); }
      input[type="file"] { color: #fff; }
      input[type="range"] { width: 100%; }
      .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
      button {
        background: var(--accent);
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
      }
      button:disabled { opacity: 0.5; cursor: not-allowed; }
      canvas {
        background: #000;
        display: block;
        width: 100%;
        max-height: 480px;
        margin-top: 8px;
        border-radius: 6px;
      }
      .small { font-size: 12px; color: var(--muted); }
      input[type="number"] {
        width: 100px;
        padding: 6px;
        border-radius: 6px;
        border: 1px solid #21324b;
        background: #071025;
        color: #e6eef8;
      }
      .controls { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
    </style>
  </head>
  <body>
    <h2>Video Transformer â€” Teleporting Watermark + Custom Resizing</h2>

    <div class="panel">
      <label>1) Upload source video</label>
      <input id="videoFile" type="file" accept="video/*" />
      <div class="row" style="margin-top: 8px">
        <div><label>Video width (px)</label><input id="videoWidth" type="number" min="1" value="640" /></div>
        <div><label>Video height (px)</label><input id="videoHeight" type="number" min="1" value="360" /></div>
        <div><label>&nbsp;</label><input id="lockVideoAspect" type="checkbox" checked /><span class="small">Lock aspect ratio</span></div>
      </div>
    </div>

    <div class="panel">
      <label>2) Upload watermark image (optional)</label>
      <input id="wmFile" type="file" accept="image/*" />
      <div class="row" style="margin-top: 8px">
        <div><label>Watermark width (px)</label><input id="wmWidth" type="number" min="1" value="80" /></div>
        <div><label>Watermark height (px)</label><input id="wmHeight" type="number" min="1" value="37" /></div>
        <div><label>&nbsp;</label><input id="lockWmAspect" type="checkbox" checked /><span class="small">Lock aspect ratio</span></div>
        <div><label>Opacity (%)</label><input id="wmOpacity" type="range" min="0" max="100" value="45" /></div>
      </div>
    </div>

    <div class="panel">
      <label>3) Noise settings</label>
      <div class="row">
        <div style="flex: 1"><label>Noise opacity (%)</label><input id="noiseRange" type="range" min="0" max="100" value="4" /></div>
        <div><label>Noise update interval</label><div class="small">Fixed at 0.1s</div></div>
      </div>
    </div>

    <div class="panel controls">
      <button id="applyBtn">Apply & Preview</button>
      <button id="downloadBtn" disabled>Download (processed)</button>
      <button id="stopRecordBtn" style="display:none;">Cancel</button>
    </div>

    <div class="panel">
      <label>Preview (click canvas to reposition watermark manually)</label>
      <canvas id="workCanvas"></canvas>
    </div>

    <script>
      (async () => {
        const TELEPORT_INTERVAL = 2700;
        const NOISE_INTERVAL = 100;
        const videoFileInput = document.getElementById("videoFile");
        const wmFileInput = document.getElementById("wmFile");
        const canvas = document.getElementById("workCanvas");
        const ctx = canvas.getContext("2d");
        let srcVideo = document.createElement("video");
        let watermarkImg = new Image();
        let watermarkLoaded = false;

        const response = await fetch('1760703109656.png_dataurl.txt');
        const DEFAULT_WATERMARK_DATAURL = await response.text();

        wmFileInput.addEventListener("change", (e) => {
          const f = e.target.files[0];
          if (!f) {
            watermarkImg.src = DEFAULT_WATERMARK_DATAURL;
            watermarkLoaded = true;
            return;
          }
          const url = URL.createObjectURL(f);
          watermarkImg.onload = () => {
            watermarkLoaded = true;
            URL.revokeObjectURL(url);
          };
          watermarkImg.src = url;
        });
      })();
    </script>
  </body>
</html>
